<!DOCTYPE html>
<html>

	<head>
		<link rel="stylesheet" href="__STATIC__/css/login.css" />
		<meta charset="UTF-8">
		<script type="text/javascript" src="__STATIC__/js/jquery.min.js"></script>
		<title></title>
		
	</head>

	<body>
		<div class="login-body">
			<div class="login-top">
				<a href="{:url('index/index/index')}">
						<img class="img1" src="__STATIC__/img/logo.gif" />
				</a>
			
				<h1>用户登陆</h1>
			</div>

			<div class="login-content">
				
                <img src="__STATIC__/img/login/log_n.jpg" />
				<form  method="post" action="{:url('index/user/loginAction')}">
					<div class="login-window">
						<div class="login-list">
							<img src="__STATIC__/img/login/username.jpg">
							<input type="email" placeholder="请输入邮箱" id="email" name="email" />
						</div>
						<div class="login-list">
							<img src="__STATIC__/img/login/password.jpg" />
							<input type="password" placeholder="请输入密码" id="password" name="password" />
						</div>
						<div class="yzm">
							<div class="login-yzm">
								<p>验证码：</p><input type="text" id="code" name="code" />

							</div>
							<img id="verifyimg" src="{:url('index/user/captcha')}" border="0"  width="105px" height="47px" />
							<a onclick="javascript:verifyimg.src='{:url('index/user/captcha')}?rand='+Math.random()" style="width: 88px;height: 50px;line-height: 47px;font-size: 15px;">换一换</a>
						</div>

						<!--登陆错误-->
						<div id="login-mistake">
						</div>

						<div class="login-operate">
							<a href="{:url('index/user/reg')}">免费注册</a>
							<span>丨</span>
							<a href="#">忘记密码</a>
						</div>
						<div>
							<input type="submit" value="登陆" class="login-btn" id="login" />
						</div>

					</div>
					
				</form>
			</div>
		</div>
	</body>
    

  <script type="text/javascript">
        	
	// 检测邮箱
		 $(document).ready(function(){		 	
		 	var email_status = false;  
        	$('#email').bind('blur',function(){
        		var uemail= $(this).val();
        		if(!$(this).val()) {
        			$(this).next().removeClass("glyphicon glyphicon-ok").addClass("error-style").html('邮箱不能为空');
        			email_status = false;
        		}else{
        			var reg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-]+)+$/;
                    var result = reg.test(uemail);
                    if(!result){
				        $(this).next().removeClass("glyphicon glyphicon-ok").addClass("error-style").html('邮箱格式不正确！');
				    }else{
		                $.post('{:url('index/user/checkEmail')}',{email:uemail},function(data){
		                if(data == true){
		                   $("#email-check").removeClass("glyphicon glyphicon-ok").addClass("error-style").html('用户已存在，请更换邮箱');
						          
		                }else{
			                $("#email-check").addClass("error-style").css("color","green").addClass("glyphicon glyphicon-ok").html('');
			                email_status = true;
			            }
        			})
    
        		   }
				  }
        	    })
        });

     

    </script>
					<script type="text/javascript">
						$(function() {
							//检查各个表单是否为空
							
							$("#login").bind('click',function() {
								if($("#username").val() == "" || $("#password").val() == "") {
									$("#login-mistake").addClass("login-mistake");
									$("#login-mistake").text("请输入邮箱或密码！");
								}
								else{
									if($("#code").val()==""){
										$("#login-mistake").addClass("login-mistake");
									    $("#login-mistake").text("请输入验证码！");
									}
								}
								
								
							});
								
						})
					</script>
</html>